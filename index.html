<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Mind Garden â€“ Habits & Journal</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Mind Garden">

<style>
:root{
  --bg:#020617;--card:#0f172a;--muted:#94a3b8;
  --g1:#dcfce7;--g2:#86efac;--g3:#22c55e;--g4:#15803d;
}
*{box-sizing:border-box}
body{margin:0;font-family:-apple-system,system-ui;background:linear-gradient(180deg,#020617,#022c22);color:#fff;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}
header{text-align:center;padding:1rem}
main{max-width:560px;margin:auto;padding:1rem}
.card{background:rgba(15,23,42,.9);border-radius:18px;padding:1rem;margin-bottom:1rem}
.row{display:flex;gap:.5rem;align-items:center}
input,textarea,button{background:#020617;border:1px solid #1f2937;border-radius:12px;color:#fff;padding:.6rem;font-family:inherit}
button{cursor:pointer}
.habit{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #1f2937;padding:.4rem 0}
.check{width:24px;height:24px;border-radius:50%;border:2px solid #22c55e;display:flex;align-items:center;justify-content:center;cursor:pointer}
.check.done{background:#22c55e;color:#022c22;font-weight:bold}
.heat{width:16px;height:16px;border-radius:4px;cursor:pointer}
.garden{display:grid;grid-template-columns:repeat(auto-fit,minmax(60px,1fr));gap:.5rem}
.plant{height:60px;border-radius:12px;background:#020617;border:1px solid #1f2937;display:flex;align-items:flex-end;justify-content:center;overflow:hidden}
.plant span{width:100%;display:block;background:linear-gradient(180deg,#86efac,#22c55e)}
.flower{font-size:1.4rem;line-height:1}
.small{font-size:.75rem;color:var(--muted)}
table{border-collapse:collapse;font-size:.7rem}
th,td{text-align:center;padding:2px}
th:first-child,td:first-child{text-align:left;padding-right:6px}
.year{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem}
.year div{font-size:.65rem}
</style>
</head>
<body>
<header>
<h1>ðŸŒ± Mind Garden</h1>
<div class="small">Habits Â· Journal Â· Growth</div>
</header>
<main>

<div class="card row">
<input id="habitInput" placeholder="Add habit" style="flex:1">
<button onclick="addHabit()">+</button>
<input type="date" id="datePicker">
</div>

<div class="card" id="habitList"></div>

<div class="card">
<strong>Journal</strong>
<textarea id="journal" style="width:100%;height:90px;margin-top:.5rem" placeholder="Thoughts for this dayâ€¦"></textarea>
<button style="width:100%;margin-top:.5rem" onclick="saveJournal()">Save</button>
</div>

<div class="card">
<strong>Monthly Heatmap</strong>
<div id="monthLabel" class="small"></div>
<div id="monthly"></div>
</div>

<div class="card">
<strong>Year View</strong>
<div id="year" class="year"></div>
</div>

<div class="card">
<strong>Garden</strong>
<div id="garden" class="garden"></div>
</div>

</main>

<script>
const dp=document.getElementById('datePicker');
dp.value=new Date().toISOString().slice(0,10);

const heatColor=p=>p===0?'#020617':p<.25?'var(--g1)':p<.5?'var(--g2)':p<.75?'var(--g3)':'var(--g4)';

const load=()=>JSON.parse(localStorage.getItem('habits')||'[]');
const save=h=>localStorage.setItem('habits',JSON.stringify(h));

function addHabit(){const i=document.getElementById('habitInput');if(!i.value.trim())return;const h=load();h.push({name:i.value,done:[]});save(h);i.value='';render();}

function toggle(i){const h=load();const d=dp.value;const a=h[i].done;const x=a.indexOf(d);x>=0?a.splice(x,1):a.push(d);save(h);render();}

function render(){
const h=load();const d=dp.value;
const hl=document.getElementById('habitList');hl.innerHTML='';
const jKey='j-'+d;document.getElementById('journal').value=localStorage.getItem(jKey)||'';

h.forEach((x,i)=>{
const row=document.createElement('div');row.className='habit';
row.innerHTML=`<div>${x.name}</div><div class="check ${x.done.includes(d)?'done':''}" onclick="toggle(${i})">${x.done.includes(d)?'âœ“':''}</div>`;
hl.appendChild(row);
});
renderMonth();renderGarden();renderYear();}

function saveJournal(){localStorage.setItem('j-'+dp.value,document.getElementById('journal').value)}

function renderMonth(){
const h=load();const c=document.getElementById('monthly');const l=document.getElementById('monthLabel');
const sel=new Date(dp.value);const y=sel.getFullYear(),m=sel.getMonth();
l.textContent=sel.toLocaleDateString(undefined,{month:'long',year:'numeric'});
const days=new Date(y,m+1,0).getDate();
let t='<table><tr><th>Habit</th>';
for(let d=1;d<=days;d++)t+=`<th>${d}</th>`;t+='</tr>';

h.forEach(x=>{
let count=0;t+=`<tr><td>${x.name}</td>`;
for(let d=1;d<=days;d++){
const k=`${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
const done=x.done.includes(k);if(done)count++;
const pct=count/days;
t+=`<td><div class="heat" onclick="jump('${k}')" style="background:${heatColor(done?1:0)}"></div></td>`;
}
t+=`<td class="small">${Math.round((count/days)*100)}%</td></tr>`;
});
c.innerHTML=t+'</table>';
}

function jump(k){dp.value=k;render();}

function renderGarden(){
const g=document.getElementById('garden');g.innerHTML='';
load().forEach(x=>{
const p=Math.min(1,x.done.length/30);
const div=document.createElement('div');div.className='plant';
if(p>.7)div.innerHTML='<div class="flower">ðŸŒ¸</div>';
else div.innerHTML=`<span style="height:${p*100}%"></span>`;
g.appendChild(div);
});}

function renderYear(){
const y=document.getElementById('year');y.innerHTML='';
const h=load();const year=new Date(dp.value).getFullYear();
for(let m=0;m<12;m++){
let total=0,done=0;const days=new Date(year,m+1,0).getDate();
h.forEach(x=>{
for(let d=1;d<=days;d++){
total++;const k=`${year}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
if(x.done.includes(k))done++;}
});
const div=document.createElement('div');
div.style.background=heatColor(done/total);
div.textContent=new Date(year,m,1).toLocaleString(undefined,{month:'short'});
y.appendChild(div);
}}

dp.onchange=render;render();
</script>
</body>
</html>
